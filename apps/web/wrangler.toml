#:schema node_modules/wrangler/config-schema.json
name = "listentomore-web"
main = "src/index.tsx"
compatibility_date = "2024-11-01"
compatibility_flags = ["nodejs_compat"]

# Custom domain
routes = [
  { pattern = "listentomore.com", custom_domain = true }
]

# Static assets (favicons, etc.)
[assets]
directory = "./public"

# Smart placement for optimal performance
[placement]
mode = "smart"

# Observability
[observability]
enabled = true

# KV Namespace for caching
[[kv_namespaces]]
binding = "CACHE"
id = "a6011a8b5bac4be9a472ff86f8d5fd91"
preview_id = "d6703c6a7283467eb7a452a6cb34fa87"

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "listentomore"
database_id = "512d0c41-502c-41ba-82ff-635d0413b071"

# Environment variables
[vars]
ENVIRONMENT = "production"

# Scheduled triggers (CRON jobs)
[triggers]
crons = ["*/5 * * * *"]  # Run every 5 minutes (random fact only at top of hour)

# Note: Secrets should be set with `wrangler secret put`:
# - SPOTIFY_CLIENT_ID
# - SPOTIFY_CLIENT_SECRET
# - SPOTIFY_REFRESH_TOKEN
# - LASTFM_API_KEY
# - OPENAI_API_KEY
# - PERPLEXITY_API_KEY
# - DISCOGS_API_TOKEN
# - YOUTUBE_API_KEY (for streaming links service)
# - INTERNAL_API_SECRET (for signing internal API tokens)
# - APPLE_KEY_ID
# - APPLE_TEAM_ID
# - APPLE_PRIVATE_KEY
